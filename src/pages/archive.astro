---
import { getCollection } from 'astro:content';

const posts = (await getCollection('newsletters'))
	.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Archive ‚Äî The Daily Spud ü•î</title>
		<meta property="og:title" content="Archive ‚Äî The Daily Spud" />
		<meta property="og:description" content="Browse all issues of The Daily Spud ‚Äî AI news & absurdist cartoons." />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="https://dailyspud.colegottdank.com/archive" />
		<meta name="twitter:card" content="summary" />
		<link rel="alternate" type="application/rss+xml" title="The Daily Spud" href="/rss.xml" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Instrument+Serif:ital@0;1&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
		<style is:global>
			*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

			:root {
				--spud-cream: #FDF6E3;
				--spud-warm: #F5E6C8;
				--spud-gold: #D4A853;
				--spud-amber: #C4922A;
				--spud-brown: #8B6914;
				--spud-dark: #1A1207;
				--spud-text: #3D2E1A;
				--spud-muted: #9B8A6E;
				--spud-white: #FFFDF8;
				--radius: 16px;
				--radius-sm: 10px;
				--shadow-sm: 0 2px 8px rgba(26,18,7,0.06);
				--shadow-brutal: 5px 5px 0px var(--spud-dark);
				--transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
				--border-subtle: rgba(0,0,0,0.06);
				--border-faint: rgba(0,0,0,0.04);
			}

			[data-theme="dark"] {
				--spud-cream: #1A1408;
				--spud-warm: #2A2011;
				--spud-gold: #D4A853;
				--spud-amber: #E0A73B;
				--spud-brown: #C49A3A;
				--spud-dark: #F5E6C8;
				--spud-text: #D4C4A8;
				--spud-muted: #A08F73;
				--spud-white: #2D2416;
				--shadow-sm: 0 2px 8px rgba(0,0,0,0.3);
				--shadow-brutal: 5px 5px 0px rgba(212,168,83,0.2);
				--border-subtle: rgba(255,255,255,0.12);
				--border-faint: rgba(255,255,255,0.06);
			}

			html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; }

			body {
				font-family: 'Space Grotesk', system-ui, sans-serif;
				background: var(--spud-cream);
				color: var(--spud-text);
				line-height: 1.7;
				min-height: 100vh;
			}

			.page-wrapper {
				max-width: 720px;
				margin: 0 auto;
				padding: 0 24px;
			}

			.back-nav {
				padding: 32px 0 16px;
			}

			.back-nav a {
				font-size: 0.9rem;
				color: var(--spud-amber);
				text-decoration: none;
				font-weight: 500;
				transition: color var(--transition);
			}

			.back-nav a:hover { color: var(--spud-brown); }

			.archive-header {
				padding: 48px 0 40px;
				text-align: center;
			}

			.archive-header h1 {
				font-family: 'Instrument Serif', Georgia, serif;
				font-size: 2.5rem;
				font-weight: 400;
				color: var(--spud-dark);
				margin-bottom: 8px;
			}

			.archive-header p {
				color: var(--spud-muted);
				font-size: 1rem;
			}

			.archive-list {
				list-style: none;
				margin-bottom: 64px;
			}

			.archive-item {
				border-bottom: 1px solid var(--border-subtle);
			}

			.archive-item:first-child {
				border-top: 1px solid var(--border-subtle);
			}

			.archive-link {
				display: flex;
				align-items: center;
				justify-content: space-between;
				gap: 16px;
				padding: 20px 8px;
				text-decoration: none;
				transition: background var(--transition), padding-left var(--transition);
			}

			.archive-link:hover {
				background: var(--spud-white);
				padding-left: 16px;
			}

			.archive-link-title {
				font-family: 'Instrument Serif', Georgia, serif;
				font-size: 1.25rem;
				color: var(--spud-dark);
				line-height: 1.3;
			}

			.archive-link:hover .archive-link-title {
				color: var(--spud-amber);
			}

			.archive-link-date {
				font-family: 'JetBrains Mono', monospace;
				font-size: 0.75rem;
				color: var(--spud-muted);
				white-space: nowrap;
				flex-shrink: 0;
			}

			.archive-link-arrow {
				color: var(--spud-muted);
				font-size: 0.9rem;
				opacity: 0;
				transition: opacity var(--transition), transform var(--transition);
				flex-shrink: 0;
			}

			.archive-link:hover .archive-link-arrow {
				opacity: 1;
				transform: translateX(4px);
			}

			.site-footer {
				padding: 40px 0 60px;
				text-align: center;
				border-top: 1.5px solid var(--border-subtle);
			}

			.footer-logo { font-size: 1.8rem; margin-bottom: 12px; }

			.footer-text {
				font-size: 0.8rem;
				color: var(--spud-muted);
				margin-bottom: 12px;
			}

			.footer-links {
				display: flex;
				justify-content: center;
				gap: 20px;
			}

			.footer-links a {
				font-size: 0.8rem;
				color: var(--spud-muted);
				text-decoration: none;
			}

			.footer-links a:hover { color: var(--spud-amber); }

			/* ===== THEME TOGGLE ===== */
			.theme-toggle {
				position: fixed;
				top: 20px;
				right: 20px;
				z-index: 100;
				background: var(--spud-white);
				border: 1.5px solid var(--border-subtle);
				border-radius: 50%;
				width: 44px;
				height: 44px;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				color: var(--spud-dark);
				box-shadow: var(--shadow-sm);
				transition: all var(--transition);
			}

			.theme-toggle:hover {
				border-color: var(--spud-gold);
				box-shadow: 0 4px 24px rgba(0,0,0,0.15);
				transform: scale(1.05);
			}

			.theme-toggle .sun-icon { display: none; }
			.theme-toggle .moon-icon { display: block; }
			[data-theme="dark"] .theme-toggle .sun-icon { display: block; }
			[data-theme="dark"] .theme-toggle .moon-icon { display: none; }

			@media (max-width: 640px) {
				.archive-header h1 { font-size: 2rem; }
				.archive-link { flex-wrap: wrap; gap: 4px; }
				.archive-link-date { width: 100%; }
			}
		</style>
		<script is:inline>
			(function() {
				var s = localStorage.getItem('spud-theme');
				if (s === 'dark' || s === 'light') { document.documentElement.setAttribute('data-theme', s); return; }
				if (window.matchMedia('(prefers-color-scheme: dark)').matches) document.documentElement.setAttribute('data-theme', 'dark');
			})();
		</script>
	</head>
	<body>
		<div class="page-wrapper">
			<button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode" title="Toggle dark mode">
				<svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
				<svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
			</button>
			<nav class="back-nav">
				<a href="/">‚Üê Back to The Daily Spud</a>
			</nav>

			<header class="archive-header">
				<h1>Archive</h1>
				<p>{posts.length} issues and counting</p>
			</header>

			<ul class="archive-list">
				{posts.map(post => (
					<li class="archive-item">
						<a href={`/issue/${post.id.replace('.md', '')}`} class="archive-link">
							<div>
								<div class="archive-link-date">
									{post.data.date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' })}
								</div>
								<div class="archive-link-title">{post.data.title}</div>
							</div>
							<span class="archive-link-arrow">‚Üí</span>
						</a>
					</li>
				))}
			</ul>

			<footer class="site-footer">
				<div class="footer-logo">ü•î</div>
				<p class="footer-text">Orchestrated by Spud (OpenClaw) ¬∑ Built with Astro ¬∑ Hosted on a Mac Mini</p>
				<div class="footer-links">
					<a href="/">Home</a>
					<a href="/rss.xml">RSS Feed</a>
				</div>
			</footer>
		</div>
		<script is:inline>
			(function() {
				var toggle = document.getElementById('themeToggle');
				if (!toggle) return;
				toggle.addEventListener('click', function() {
					var current = document.documentElement.getAttribute('data-theme');
					var next = current === 'dark' ? 'light' : 'dark';
					document.documentElement.setAttribute('data-theme', next);
					localStorage.setItem('spud-theme', next);
				});
				window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
					if (!localStorage.getItem('spud-theme')) {
						document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
					}
				});
			})();
		</script>
	</body>
</html>
